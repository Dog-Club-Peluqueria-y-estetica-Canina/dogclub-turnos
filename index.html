<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Dog Club - PeluquerÃ­a y EstÃ©tica Canina</title>

  <!-- FullCalendar -->
  <link href="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.css" rel="stylesheet"/>
  <script src="https://cdn.jsdelivr.net/npm/fullcalendar@6.1.11/index.global.min.js"></script>

  <!-- Choices.js -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
  <script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>

  <!-- Fuente -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet"/>

  <style>
    :root{
      --turquesa: #26c6da;
      --turquesa-oscuro: #1fa3b7;
      --blanco: #ffffff;
      --texto: #222;
      --max-width: 980px;
    }
    body{
      margin:0;
      font-family: "Poppins", Arial, sans-serif;
      background-color: #f0fbfc;
      background-image: radial-gradient(rgba(38,198,218,0.08) 1px, transparent 1px),
                        radial-gradient(rgba(38,198,218,0.08) 1px, transparent 1px);
      background-size: 40px 40px;
      background-position: 0 0, 20px 20px;
      color: var(--texto);
    }
    .wrap{ max-width: var(--max-width); margin: 30px auto; padding: 18px; }
    .card{ background: var(--blanco); border-radius: 16px; box-shadow: 0 8px 30px rgba(8, 40, 50, 0.08); padding: 24px; transition: all 0.4s ease; animation: fadeIn 0.8s ease; }

    .brand { display:flex; flex-direction:column; align-items:center; justify-content:center; text-align:center; margin-bottom:20px; gap:10px;}
    .brand img{ display:block; width:auto; height:auto; max-width:500px; max-height:500px; object-fit:contain; background:transparent; }
    @media(max-width:720px){ .brand img{ max-width:280px; max-height:280px; } }

    h3{ color: var(--turquesa-oscuro); border-left:5px solid var(--turquesa); padding-left:10px; }
    label{ display:block; margin-top:12px; font-weight:600; color:#333; }
    input, select, textarea{ width:100%; padding:10px 12px; border-radius:8px; border:1px solid #d7e9ea; margin-top:6px; font-size:15px; transition: border 0.2s ease; }
    input:focus, select:focus, textarea:focus{ border-color: var(--turquesa); outline: none; box-shadow: 0 0 3px rgba(38,198,218,0.3); }

    .btn{ display:inline-flex; align-items:center; justify-content:center; background:var(--turquesa); color:#fff; border:none; padding:12px 16px; border-radius:10px; font-weight:700; cursor:pointer; margin-top:18px; gap:8px; font-size:15px; transition: all 0.3s ease; }
    .btn:hover{ background:var(--turquesa-oscuro); transform: translateY(-2px); box-shadow:0 6px 15px rgba(38,198,218,0.25);}

    #calendar{ max-width:780px; margin:20px auto; border-radius:12px; box-shadow:0 4px 15px rgba(0,0,0,0.05); overflow:hidden; }
    .turno-btns{ display:flex; justify-content:center; gap:20px; margin-top:15px; animation: fadeIn 0.4s ease; }
    .turno-btns button{ background:var(--turquesa); color:white; border:none; padding:14px 24px; border-radius:12px; cursor:pointer; font-weight:bold; transition:0.2s; font-size:16px; }
    .turno-btns button:hover{ background:#1fa3b7; transform: scale(1.05); }

    .cupos-info {
      background: #e0f7fa;
      border: 1px solid #b2ebf2;
      padding: 10px;
      border-radius: 10px;
      text-align: center;
      font-weight: 600;
      margin: 15px auto 0 auto;
      max-width: 400px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      display: none;
    }

    .qr-section { text-align: center; margin-top: 20px; }
    .qr-section img { width: 220px; height: auto; border-radius: 10px; margin-bottom: 15px; }
    .bank-info { text-align: left; margin: 0 auto; max-width: 420px; font-size: 16px; }
    .bank-info p { display: flex; align-items: center; gap: 8px; margin: 6px 0; }

    .info-box {
      background-color: #fff3cd;
      border: 1px solid #ffeeba;
      color: #856404;
      padding: 14px;
      border-radius: 10px;
      margin: 15px auto 25px auto;
      max-width: 600px;
      font-size: 15px;
      line-height: 1.5;
    }

    footer { background-color: #ffffff; border-top: 3px solid var(--turquesa); display: flex; justify-content: space-between; align-items: stretch; padding: 20px; flex-wrap: wrap; gap: 20px; margin-top: 40px; }
    footer iframe { border: none; border-radius: 12px; width: 48%; height: 250px; }
    footer .contacto { width: 48%; display: flex; flex-direction: column; justify-content: center; gap: 6px; font-size: 15px; }
    footer .contacto p { margin: 0; display: flex; align-items: center; gap: 8px; }

    @keyframes fadeIn{ from{ opacity:0; transform:translateY(10px);} to{ opacity:1; transform:translateY(0);} }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="brand">
        <img src="logo.png" alt="Dog Club Logo">
      </div>

      <!-- Paso 1 -->
      <div id="step1">
        <h3>Datos del cliente y mascota</h3>
        <form id="formStep1">
          <label for="nombreDueno">Nombre del dueÃ±o *</label>
          <input id="nombreDueno" name="nombreDueno" type="text" maxlength="20" required>

          <label for="celular">Celular *</label>
          <input id="celular" name="celular" type="tel" maxlength="20" pattern="[0-9]{6,20}" title="Solo nÃºmeros, mÃ­nimo 6 dÃ­gitos" required>

          <label for="nombreMascota">Nombre de la mascota *</label>
          <input id="nombreMascota" name="nombreMascota" type="text" maxlength="15" required>

          <label for="edad">Edad *</label>
          <input id="edad" name="edad" type="text" maxlength="3" pattern="[0-9]{1,3}" title="Solo nÃºmeros (mÃ¡x. 3 cifras)" required>

          <label for="raza">Raza *</label>
          <select id="raza" name="raza" required></select>

          <div id="razaOtra" style="display:none; margin-top:8px;">
            <label for="otraRaza">EspecificÃ¡ la raza *</label>
            <input id="otraRaza" name="otraRaza" type="text" maxlength="15" placeholder="EscribÃ­ la raza">
          </div>

          <label for="tamano">TamaÃ±o *</label>
          <select id="tamano" name="tamano" required>
            <option value="">SeleccionÃ¡</option>
            <option value="Grande">Grande</option>
            <option value="Mediano">Mediano</option>
            <option value="PequeÃ±o">PequeÃ±o</option>
          </select>

          <label>Tipo de servicio *</label>
          <div>
            <label><input type="checkbox" name="servicio" value="BaÃ±o"> ğŸ§¼ BaÃ±o</label>
            <label><input type="checkbox" name="servicio" value="Corte"> âœ‚ï¸ Corte</label>
          </div>

          <label>Â¿Tiene algÃºn problema de salud o alergia?</label>
          <div>
            <label><input type="radio" name="saludAlergia" value="No" checked> No</label>
            <label><input type="radio" name="saludAlergia" value="Si"> SÃ­</label>
          </div>

          <div id="campoSaludAlergia" style="display:none;">
            <label for="descripcionSaludAlergia">DescribÃ­ brevemente</label>
            <input id="descripcionSaludAlergia" name="descripcionSaludAlergia" type="text" maxlength="25">
          </div>

          <button type="submit" class="btn" id="toStep2">Siguiente â€” Elegir fecha ğŸ—“ï¸</button>
        </form>
      </div>

      <!-- Paso 2 -->
      <div id="step2" style="display:none;">
        <h3>SeleccionÃ¡ un dÃ­a y turno disponible ğŸ—“ï¸</h3>
        <p>Hora de ingreso: turno maÃ±ana (09:00) y turno tarde (13:00hs).</p>
        <div id="calendar"></div>
        <div id="cuposInfo" class="cupos-info" aria-live="polite"></div>
        <div class="turno-btns" id="turnoBtns" style="display:none;">
          <button id="turnoManana">ğŸŒ Turno MaÃ±ana</button>
          <button id="turnoTarde">ğŸŒ‡ Turno Tarde</button>
        </div>
        <button class="btn secondary" id="volverPaso1">â¬…ï¸ Volver</button>
      </div>

      <!-- Paso 3 -->
      <div id="step3" style="display:none;">
        <h3>Datos para transferencia ğŸ’³</h3>
        <div class="info-box">
          ğŸ“ <b>Para agendar su turno ğŸ©</b> debe abonar una seÃ±a de <b>$5000</b> por transferencia o venir al local (09â€“17 hs).<br><br>
          ğŸ’¬ La seÃ±a se descontarÃ¡ del total.
        </div>

        <div class="qr-section">
          <img src="qr.png" alt="CÃ³digo QR de pago">
          <div class="bank-info">
            <p>ğŸ¦ <b>CBU:</b> â€”</p>
            <p>ğŸ’¬ <b>Alias:</b> Dog.club.lr</p>
            <p>ğŸ‘¤ <b>Cuenta a nombre de:</b> Claudio Enzo Jimenez</p>
            <p>ğŸªª <b>DNI:</b> 20-35284426-9</p>
            <p>ğŸ›ï¸ <b>Banco:</b> Mercado Pago</p>
          </div>
        </div>
        <button class="btn secondary" id="volverPaso2">â¬…ï¸ Volver</button>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <iframe src="https://www.google.com/maps?q=Av.+Ãngel+Vicente+PeÃ±aloza,+F5300+La+Rioja&output=embed" allowfullscreen="" loading="lazy"></iframe>

    <div class="contacto">
      <p>ğŸ“ <b>DirecciÃ³n:</b> Av. Ãngel Vicente PeÃ±aloza, F5300 La Rioja</p>
      <p>ğŸ“§ <b>Email:</b> contacto@dogclub.com</p>
      <p>ğŸ“¸ <b>Instagram:</b> <a href="https://www.instagram.com/dog_clubb/" target="_blank">@dog_clubb</a></p>
      <p>ğŸ“± <b>WhatsApp:</b> <a href="https://api.whatsapp.com/message/YIYD6PN5YHWSL1?autoload=1&app_absent=0" target="_blank">+54 9 3804 104255</a></p>
    </div>
  </footer>

  <script>
    // Mostrar campo de alergia
    document.querySelectorAll('input[name="saludAlergia"]').forEach(radio => {
      radio.addEventListener('change', e => {
        document.getElementById('campoSaludAlergia').style.display = (e.target.value === 'Si') ? 'block' : 'none';
      });
    });

    // Cargar razas
    const razasArray = [
      "Caniche","Labrador Retriever","Pastor AlemÃ¡n","Golden Retriever","Bulldog FrancÃ©s",
      "Beagle","Pomerania","Border Collie","Schnauzer","Cocker Spaniel","DÃ¡lmata","Boxer",
      "Rottweiler","Shih Tzu","Bichon FrisÃ©","Bulldog InglÃ©s","Fox Terrier","MastÃ­n",
      "Akita","Siberian Husky","Chihuahua","Pinscher","PequinÃ©s","Australian Shepherd",
      "Boston Terrier","Husky Siberiano","Otro"
    ];
    razasArray.forEach(r => {
      const opt = document.createElement('option');
      opt.value = r; opt.textContent = r;
      document.getElementById('raza').appendChild(opt);
    });

    document.addEventListener("DOMContentLoaded", () => {
      new Choices("#raza", {
        searchEnabled: true,
        shouldSort: false,
        itemSelectText: '',
        placeholderValue: 'Buscar raza...',
        searchResultLimit: 50,
        fuseOptions: { threshold: 0.3 }
      });
    });

    document.getElementById('raza').addEventListener('change', e => {
      const v = e.target.value;
      if (v && v.toLowerCase() === 'otro') {
        document.getElementById('razaOtra').style.display = 'block';
        document.getElementById('otraRaza').setAttribute('required','required');
      } else {
        document.getElementById('razaOtra').style.display = 'none';
        document.getElementById('otraRaza').removeAttribute('required');
      }
    });

    // NavegaciÃ³n
    document.getElementById('toStep2').addEventListener('click', e => {
      e.preventDefault();
      document.getElementById('step1').style.display = 'none';
      document.getElementById('step2').style.display = 'block';
      if (!window.calendarInitialized) initCalendar();
    });
    document.getElementById('volverPaso1').addEventListener('click', () => {
      document.getElementById('step2').style.display = 'none';
      document.getElementById('step1').style.display = 'block';
    });
    document.getElementById('volverPaso2').addEventListener('click', () => {
      document.getElementById('step3').style.display = 'none';
      document.getElementById('step2').style.display = 'block';
    });

    // CALENDARIO
    function initCalendar() {
      const calendarEl = document.getElementById('calendar');
      const calendar = new FullCalendar.Calendar(calendarEl, {
        initialView: 'dayGridMonth',
        selectable: true,
        editable: false,
        height: "auto",
        headerToolbar: { left: 'prev,next today', center: 'title', right: '' },
        validRange: { start: new Date().toISOString().split('T')[0] },
        dateClick: info => {
          const day = info.date.getDay();
          if (day === 0) return alert("ğŸš« Domingo estÃ¡ cerrado.");

          const fecha = info.dateStr;

          // ğŸ”¹ Consultar cupos reales desde Google Sheets
          fetch("https://script.google.com/macros/s/AKfycbx-qZl14ewHn0cCoaR7WQpmmiLlTiz-nE0sK2KcCR5_4YpQzBWkZD2qvYWjEYUHm6vvOg/exec?fecha=" + fecha)
            .then(res => res.json())
            .then(data => {
              const dispManana = data.manana;
              const dispTarde = data.tarde;
              const cuposInfo = document.getElementById('cuposInfo');
              cuposInfo.style.display = 'block';
              cuposInfo.textContent = `ğŸ“… ${fecha} â€” MaÃ±ana: ${dispManana} cupos | Tarde: ${dispTarde} cupos`;
              document.getElementById('turnoBtns').style.display = 'flex';
              document.getElementById('turnoManana').onclick = () => registrarTurno(fecha, 'MaÃ±ana');
              document.getElementById('turnoTarde').onclick = () => registrarTurno(fecha, 'Tarde');
            })
            .catch(() => alert("âš ï¸ Error al obtener cupos desde la base de datos."));
        }
      });
      calendar.render();
      window.calendarInitialized = true;
    }

    // ğŸ”¹ EnvÃ­o a Google Sheets
    function registrarTurno(fecha, turno) {
      const form = document.getElementById('formStep1');
      const data = new FormData(form);
      data.append('fecha', fecha);
      data.append('turno', turno);

      fetch("https://script.google.com/macros/s/AKfycbx-qZl14ewHn0cCoaR7WQpmmiLlTiz-nE0sK2KcCR5_4YpQzBWkZD2qvYWjEYUHm6vvOg/exec", {
        method: 'POST',
        body: data
      })
      .then(r => r.text())
      .then(() => {
        document.getElementById('step2').style.display = 'none';
        document.getElementById('step3').style.display = 'block';
      })
      .catch(() => alert("âš ï¸ Error al registrar el turno."));
    }
  </script>
</body>
</html>
